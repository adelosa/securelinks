# Secure Links

Demonstrate use of HMAC digests to secure links that can be used
in a web application registration process.

## src/link.py

### create_link_code

Generates a new link code.

    create_link_code(
        data: str, 
        valid_for_seconds: int, 
        key: bytes, 
        hash_method: str = 'sha256'
    ) -> str

#### Input

| parameter         | description                                                                                                                  |
|-------------------|------------------------------------------------------------------------------------------------------------------------------|
| data              | Any information that you want to include with the registration request - like customer number, account number, email address |
| valid_for_seconds | How many seconds should the link be valid for                                                                                |
| key               | Bytes key used to generate the secure message digest                                                                         |
| hash_method       | The HMAC algorithm to use                                                                                                    |

#### Returns

* str: Link code

### validate_link_code

Validates a given link code.

    validate_link_code(
        link_code: str, 
        key: bytes
    ) -> tuple[str, datetime.datetime, str]:

| parameter   | description                                                |
|-------------|------------------------------------------------------------|
| link_code   | the link code generated by the `create_link_code` function |
| key         | Bytes key used to generate the secure message digest       |

#### Returns

* str: data 
* datetime: valid until date - Link code expiry time
* str: hash function
